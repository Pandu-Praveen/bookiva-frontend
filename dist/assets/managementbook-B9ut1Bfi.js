import{A as c}from"./config-XSboSa-d.js";fetch(c+"/profile",{credentials:"include",headers:{"Content-Type":"application/json"}}).then(e=>(e.status!=200&&(sessionStorage.clear(),localStorage.clear(),window.history.pushState(null,"",window.location.href),window.onpopstate=function(){window.history.pushState(null,"",window.location.href)},location.href="/login/"),e.json())).then(e=>{console.log(e),e.role!="MANAGEMENT"&&(sessionStorage.clear(),localStorage.clear(),window.history.pushState(null,"",window.location.href),window.onpopstate=function(){window.history.pushState(null,"",window.location.href)},location.href="/login/")});let g,v,S,m;feather.replace();C();async function C(){const e=await fetch(c+"/getmanagementprebook",{credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();e.status!=200&&(location.href="/venues/"),console.log(t),g=t.HALL,v=t.SEATS,S=t.DATE,console.log(S),document.querySelector(".hall-name").innerHTML=g,document.querySelector(".hall-image").setAttribute("src","/sigma.jpg"),m=[],S.forEach(l=>{let n=new Date(l),o=n.getFullYear(),a=(n.getMonth()+1).toString().padStart(2,"0"),s=n.getDate().toString().padStart(2,"0");m.push(s+"-"+a+"-"+o)}),console.log(m),document.querySelector("#date").value=m,document.querySelector(".seats-needed").innerText=`Seats required (Max: ${v}):*`,document.querySelector("#seats").setAttribute("max",v)}const q=document.querySelector(".user-menu");document.querySelector(".user-nav").addEventListener("click",e=>{q.classList.toggle("user-menu-hidden")});j();let I,d;async function j(){I=await fetch(c+"/profile",{credentials:"include",headers:{"Content-Type":"application/json"}}),d=await I.json();const e=d.name,t=d.email;if(document.querySelector("#email").value=t,document.querySelector("#name").value=e,document.querySelector(".user-menu").addEventListener("click",l=>{q.classList.toggle("user-menu-hidden")}),d.role==="MANAGEMENT"){const l=document.querySelector(".user-menu");l.innerHTML=`
    <h3 class="ff-inter">Welcome, ${e}</h3>
    <a class="ff-inter fs-2s user-menu-link" href="/management/">Profile</a>
    <a class="ff-inter fs-2s user-menu-link" href="/contactus/">Contact</a>
    <a class="ff-inter fs-2s user-menu-link log-out" href="#" style="color:red; font-weight:bold;">Log out</a>
  `,document.querySelector(".log-out").addEventListener("click",n=>{n.preventDefault(),fetch(c+"/logout",{credentials:"include",headers:{"Content-Type":"application/json"}}),location.href="/login/"})}else fetch(c+"/logout",{credentials:"include",headers:{"Content-Type":"application/json"}}),location.href="/login/"}const p=document.querySelector(".msg-box");var f="";const L=(e,t)=>{p.innerHTML=`<div style="display:flex; align-items: center; gap: 0.5rem; margin-bottom: 
    1rem;">${t?'<i data-feather="check-circle"></i><p class="ff-inter fs-s fw-500">Booking was successful! Check your mail for confirmation:</p>':'<i data-feather="x-circle"></i><p class="ff-inter fs-s fw-500">Something went wrong! Please try after some time or contact admin</p>'}
     </div>`,p.innerHTML+=`${e}`,feather.replace(),p.classList.remove("msg-box-hidden"),H()},H=()=>{setTimeout(()=>{p.classList.add("msg-box-hidden")},3e3)};var E=document.getElementById("ConfirmButton");E.addEventListener("click",async e=>{e.preventDefault();let t=[],l=document.querySelector("#guest").value;if(l.length!=0){let r=JSON.parse(l);for(let A of r)t.push(A.value)}E.innerHTML='<span class="loader" style="border-top: 3px solid #fff;height: 24px; width: 24px;"></span>',E.classList.add("disabled");let n=[],o=document.getElementById("start-time-hr").value,a=document.getElementById("start-time-min").value,s=document.getElementById("start-time-ampm").value,i=document.getElementById("end-time-hr").value,w=document.getElementById("end-time-min").value,k=document.getElementById("end-time-ampm").value,h=document.getElementById("Refreshments for").value,u=document.getElementById("Type of Refreshments").value,T=document.querySelector("#refreshments").value;var x=document.querySelectorAll('input[type="checkbox"]');console.log(h,u,n,o,a,s,i,w,k),T=="no"?(h="-",u="-",n="-"):u=="Snacks"?n="-":x.forEach(function(r){r.checked&&r.id!="agree"&&n.push(r.id)});let b=new Date;o=o<9?parseInt(o)+12:o,b.setUTCHours(o,a);let B=new Date;i=i<9?parseInt(i)+12:i,B.setUTCHours(i,w);const M={hall:g,id:document.querySelector("#email").value,start:b,end:B,eventname:document.querySelector("#eventname").value,purpose:document.querySelector("#purpose").value,refreshment:T,seats:document.querySelector("#seats").value,guest:t,refreshmentfor:h,refreshmenttype:u,food:n};fetch(c+"/managementbook",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M),credentials:"include"}).then(r=>{r.status===200?(f='<p class="ff-inter fs-2s">Booking was confirmed! Check your email for details</p>',L(f,!0),console.log("True"),setTimeout(()=>{location.href="/management/"},1e3)):(console.log("False"),f='<p class="ff-inter fs-2s">Error in booking. Try again later!</p>',L(f,!1),setTimeout(()=>{location.href="/venues/"},1e3))})});document.getElementById("bruh").addEventListener("submit",D);document.getElementById("PreviewcloseButton").addEventListener("click",N);var y=document.getElementById("Previewbutton");function D(e){e.preventDefault(),y.innerHTML='<span class="loader" style="border-top: 3px solid #fff;height: 24px; width: 24px;"></span>',y.classList.add("disabled");let t=document.getElementById("start-time-hr").value.toString().padStart(2,"0"),l=document.getElementById("start-time-min").value.toString().padStart(2,"0"),n=document.getElementById("start-time-ampm").value,o=document.getElementById("end-time-hr").value.toString().padStart(2,"0"),a=document.getElementById("end-time-min").value.toString().padStart(2,"0"),s=document.getElementById("end-time-ampm").value;console.log(t,l,n,o,a,s),document.getElementById("popupName").innerText=g,document.getElementById("Date").innerHTML="<br><span style='color: brown;'>"+m.join("</span><br><span style='color: brown;'>")+"</span>",document.getElementById("starttime").innerText=`${t}-${l}-${n}`,document.getElementById("endtime").innerText=`${o}-${a}-${s}`,document.getElementById("eventName").innerText=document.querySelector("#eventname").value,document.getElementById("Confirmpopup").style.display="block",document.querySelector(".navv-main").style.display="none",document.querySelector(".home-content").style.filter="blur(8px)"}localStorage.setItem("x",1);function N(){y.innerHTML='<span class="butt-main sign-in ff-inter fs-2s submit">Book the Hall</span>',y.classList.remove("disabled"),document.getElementById("Confirmpopup").style.display="none",document.querySelector(".navv-main").style.display="block",document.querySelector(".home-content").style.filter="none",guestInput.style.display="block"}
