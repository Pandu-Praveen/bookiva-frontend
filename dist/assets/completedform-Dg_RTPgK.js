import{A as c}from"./config-XSboSa-d.js";feather.replace();const p=document.querySelector(".user-menu");document.querySelector(".user-nav").addEventListener("click",t=>{p.classList.toggle("user-menu-hidden")});let u,l;y();async function y(){u=await fetch(c+"/profile",{credentials:"include",headers:{"Content-Type":"application/json"}}),l=await u.json(),console.log(l.name);const t=l.name;if(l.email,l.role!="USER"&&(location.href="/login/"),u.status==200){console.log("200");const a=document.querySelector(".user-menu");a.innerHTML=`
        <h3 class="ff-inter">Welcome, ${t}</h3>
        <a class="ff-inter fs-2s user-menu-link" href="/profile/">Profile</a>
        <a class="ff-inter fs-2s user-menu-link" href="/contactus/">Contact</a>
        <a class="ff-inter fs-2s user-menu-link log-out" href="/" style="color:red; font-weight:bold;">Log out</a>
      `,document.querySelector(".log-out").addEventListener("click",n=>{n.preventDefault(),fetch(c+"/logout",{credentials:"include",headers:{"Content-Type":"application/json"}}),s();function s(){var i=history.length;history.go(-i),window.location.href="/login/"}})}}const m=window.location.search,g=m.slice(1,m.length);function h(t){return CryptoJS.AES.decrypt(t,"tamper-shouldnot-allowed").toString(CryptoJS.enc.Utf8)}const f=h(g);console.log("bookingId:",f);let e;d();async function d(){d=await fetch(c+"/completedform",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookingId:f})}),e=await d.json();const t=new Date(e.date).toLocaleDateString(),a=`${new Date(e.starttime).getUTCHours()%12||12}:${(new Date(e.starttime).getUTCMinutes()<10?"0":"")+new Date(e.starttime).getUTCMinutes()} ${new Date(e.starttime).getUTCHours()<12?"AM":"PM"}`,n=`${new Date(e.endtime).getUTCHours()%12||12}:${(new Date(e.endtime).getUTCMinutes()<10?"0":"")+new Date(e.endtime).getUTCMinutes()} ${new Date(e.endtime).getUTCHours()<12?"AM":"PM"}`;console.log(e.starttime),localStorage.setItem("x",1),document.querySelector("#date").value=t,document.querySelector("#email").value=e.email,document.querySelector("#Event").value=e.eventname,document.querySelector("#hall").value=e.hallname,document.querySelector("#starttime").value=a,document.querySelector("#endtime").value=n}var o=document.getElementById("upload");document.querySelector(".form").addEventListener("submit",async function(t){t.preventDefault();const n=document.getElementById("proof").files[0];o.innerHTML='<span class="loader" style="border-top: 3px solid #fff;height: 24px; width: 24px;"></span>',o.classList.add("disabled"),n||(alert("Please select a file."),o.innerHTML='<span class="butt-main sign-in ff-inter fs-2s submit">Upload</span>',o.classList.remove("disabled"));const s=new FormData;s.append("file",n);const i={bookingId:f};for(const r in i)s.append(r,i[r]);if(n)try{if((await fetch(c+"/upload",{method:"POST",body:s,credentials:"include"})).ok)alert("File uploaded successfully."),location.href="/profile/";else throw o.innerHTML='<span class="butt-main sign-in ff-inter fs-2s submit">Upload</span>',o.classList.remove("disabled"),new Error("Failed to upload file.")}catch(r){console.error("Error:",r),alert("Failed to upload file."),o.innerHTML='<span class="butt-main sign-in ff-inter fs-2s submit">Upload</span>',o.classList.remove("disabled")}});
