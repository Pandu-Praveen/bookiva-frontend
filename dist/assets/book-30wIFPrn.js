import{A as v}from"./config-XSboSa-d.js";W();async function W(){await fetch(v+"/profile",{credentials:"include",headers:{"Content-Type":"application/json"}}).then(a=>{a.status===401&&(location.href="/login/")})}let B,f,b,T,D,q=new Date,A=new Date,w=new Date,M=new Date,k,C,x;feather.replace();F();async function F(){B=await fetch(v+"/getprebook",{credentials:"include",headers:{"Content-Type":"application/json"}}),f=await B.json(),B.status!=200&&(location.href="/venues/"),b=f.HALL,T=f.SEATS,D=f.DATE,q=f.startTime,A=f.endTime,w=f.pstartTime,M=f.pendTime;for(let e=0;e<w.length;e++){let t=new Date(w[e]),o=t.getUTCHours();t.getUTCMinutes(),t=new Date(M[e]);let n=t.getUTCHours();t.getUTCMinutes(),o>12&&(o-=12),n>12&&(n-=12),n<o&&(n+=12);for(let s=o;s<=n;s++){if(s!=7){const i=document.querySelector(`#s${s}`);i.style.color="#FEBE10",i.style.fontWeight="bold",i.title="Already requested by someone"}const l=document.querySelector(`#e${s}`);l.style.fontWeight="bold",l.style.color="#FEBE10",l.title="Already requested by someone",s==12&&(s=0,n-=12)}}let a=[],r=[];for(let e=0;e<q.length;e++){let t=new Date(q[e]),o=t.getUTCHours();t.getUTCMinutes(),t=new Date(A[e]);let n=t.getUTCHours(),s=t.getUTCMinutes();o>12&&(o-=12),n>12&&(n-=12),a.push(n),r.push(o),s==0&&(n-=1),n<o&&(n+=12);for(let l=o;l<=n;l++){const i=document.querySelector(`#s${l}`);i.disabled=!0,i.style.color="#EF0107",i.style.fontWeight="bold",i.title="Already booked by someone";const d=document.querySelector(`#e${l}`);d.disabled=!0,d.style.fontWeight="bold",d.style.color="#EF0107",d.title="Already booked by someone",l==12&&(l=0,n-=12)}}var p=document.getElementById("start-time-hr"),c=document.getElementById("end-time-hr");c.addEventListener("change",function(){var e=parseInt(document.getElementById("end-time-hr").value),t=parseInt(document.getElementById("start-time-hr").value);for(let o=0;o<r.length;o++){let n=r[o]<9?r[o]+12:r[o];t=t<9?t+12:t,e=e<9?e+12:e,n>t&&n<e&&(e=n-1>12?n-13:n-1)}document.getElementById("end-time-hr").value=e>12?e-12:e}),p.addEventListener("change",function(){var e=parseInt(document.getElementById("start-time-hr").value);if(parseInt(document.getElementById("start-time-min").value),a.includes(parseInt(e))){document.getElementById("start-time-min").value=30;const t=document.querySelector("#s0");t.disabled=!0,t.style.fontWeight="bold",t.style.color="#F08080"}else s0.disabled=!1,s0.style.fontWeight="normal",s0.style.color="#000";for(let t=0;t<r.length;t++){let o=r[t]<9?r[t]+12:r[t];if(e=e<9?e+12:e,o==e+1){const n=document.querySelector("#s30");n.disabled=!0,n.style.fontWeight="bold",n.style.color="#F08080"}else s30.disabled=!1,s30.style.fontWeight="normal",s30.style.color="#000"}}),document.querySelector(".hall-name").innerHTML=b,document.querySelector(".hall-image").setAttribute("src","/images/sigma1.jpeg");let m=new Date(D);x=m.getFullYear(),C=(m.getMonth()+1).toString().padStart(2,"0"),k=m.getDate().toString().padStart(2,"0");let h=x+"-"+C+"-"+k;document.querySelector("#date").value=h,document.querySelector(".seats-needed").innerText=`Seats required (Max: ${T}):*`,document.querySelector("#seats").setAttribute("max",T);const u=document.querySelector(".user-menu");document.querySelector(".user-nav").addEventListener("click",e=>{u.classList.toggle("user-menu-hidden")});let g;y();async function y(){g=await fetch(v+"/profile",{credentials:"include",headers:{"Content-Type":"application/json"}});const e=await g.json();if(e.blockStatus){location.href="/block/";return}const t=e.name,o=e.email;if(document.querySelector("#email").value=o,document.querySelector("#name").value=t,document.querySelector(".user-menu").addEventListener("click",n=>{u.classList.toggle("user-menu-hidden")}),e){const n=document.querySelector(".user-menu");n.innerHTML=`
  <h3 class="ff-inter">Welcome, ${t}</h3>
  <a class="ff-inter fs-2s user-menu-link" href="/profile/">Profile</a>
  <a class="ff-inter fs-2s user-menu-link" href="/contactus/">Contact</a>
  <a class="ff-inter fs-2s user-menu-link log-out" href="/" style="color:red; font-weight:bold;">Log out</a>
    `,document.querySelector(".log-out").addEventListener("click",s=>{fetch(v+"/logout",{credentials:"include",headers:{"Content-Type":"application/json"}}),l();function l(){var i=history.length;history.go(-i),window.location.href="/login/"}})}}}const S=document.querySelector(".msg-box");var E="";const H=(a,r)=>{S.innerHTML=`<div style="display:flex; align-items: center; gap: 0.5rem; margin-bottom: 
    1rem;">${r?'<i data-feather="check-circle"></i><p class="ff-inter fs-s fw-500">Booking was successful! Check your mail for confirmation:</p>':'<i data-feather="x-circle"></i><p class="ff-inter fs-s fw-500">Something went wrong! Please try after some time or contact admin</p>'}
     </div>`,S.innerHTML+=`${a}`,feather.replace(),S.classList.remove("msg-box-hidden"),O()},O=()=>{setTimeout(()=>{S.classList.add("msg-box-hidden")},3e3)};var L=document.getElementById("ConfirmButton");L.addEventListener("click",async a=>{a.preventDefault();let r=[],p=document.querySelector("#guest").value;if(p.length!=0){let d=JSON.parse(p);for(let U of d)r.push(U.value)}L.innerHTML='<span class="loader" style="border-top: 3px solid #fff;height: 24px; width: 24px;"></span>',L.classList.add("disabled");let c=[],m=document.getElementById("start-time-hr").value,h=document.getElementById("start-time-min").value;document.getElementById("start-time-ampm").value;let u=document.getElementById("end-time-hr").value,g=document.getElementById("end-time-min").value;document.getElementById("end-time-ampm").value;let y=document.getElementById("Refreshments for").value,e=document.getElementById("Type of Refreshments").value,t=document.querySelector("#refreshments").value;var o=document.querySelectorAll('input[type="checkbox"]');t=="no"?(y="-",e="-",c="-"):e=="Snacks"?c="-":o.forEach(function(d){d.checked&&d.id!="agree"&&c.push(d.id)});let n=new Date;m=m<9?parseInt(m)+12:m,n.setUTCHours(m,h);let s=new Date;u=u<9?parseInt(u)+12:u,s.setUTCHours(u,g);const l={hall:b,id:document.querySelector("#email").value,num:document.getElementById("num").value,start:n,end:s,eventname:document.querySelector("#eventname").value,purpose:document.querySelector("#purpose").value,refreshment:t,seats:document.querySelector("#seats").value,guest:r,refreshmentfor:y,refreshmenttype:e,food:c};i();async function i(){await fetch(v+"/book",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l),credentials:"include"}).then(d=>{d.status===200?(E='<p class="ff-inter fs-2s">Booking was confirmed! Check your email for details</p>',H(E,!0),setTimeout(()=>{location.href="/profile/"},1e3)):(E='<p class="ff-inter fs-2s">Error in booking. Try again later!</p>',H(E,!1),setTimeout(()=>{location.href="/venues/"},1e3))})}});document.getElementById("bruh").addEventListener("submit",P);document.getElementById("PreviewcloseButton").addEventListener("click",N);var I=document.getElementById("Previewbutton"),$=["agree","additionalOption3","additionalOption2","additionalOption1","refreshments","purpose","guest","end-time-hr","end-time-min","end-time-ampm","start-time-hr","start-time-min","start-time-ampm","seats","num"],j=document.querySelector(".guest");function P(a){a.preventDefault(),I.innerHTML='<span class="loader" style="border-top: 3px solid #fff;height: 24px; width: 24px;"></span>',I.classList.add("disabled");let r=document.getElementById("start-time-hr").value.toString().padStart(2,"0"),p=document.getElementById("start-time-min").value.toString().padStart(2,"0"),c=document.getElementById("start-time-ampm").value,m=document.getElementById("end-time-hr").value.toString().padStart(2,"0"),h=document.getElementById("end-time-min").value.toString().padStart(2,"0"),u=document.getElementById("end-time-ampm").value;document.getElementById("popupName").innerText=b,document.getElementById("Date").innerText=k+"-"+C+"-"+x,document.getElementById("starttime").innerText=`${r}-${p}-${c}`,document.getElementById("endtime").innerText=`${m}-${h}-${u}`,document.getElementById("eventName").innerText=document.querySelector("#eventname").value,document.getElementById("Confirmpopup").style.display="block",document.querySelector(".navv-main").style.display="none",document.querySelector(".home-content").style.filter="blur(8px)",$.forEach(function(g){var y=document.getElementById(g);y&&(y.disabled=!0)}),j.style.display="none"}localStorage.setItem("x",1);function N(){I.innerHTML='<span class="butt-main sign-in ff-inter fs-2s submit">Book the Hall</span>',I.classList.remove("disabled"),document.getElementById("Confirmpopup").style.display="none",document.querySelector(".navv-main").style.display="block",document.querySelector(".home-content").style.filter="none",$.forEach(function(a){var r=document.getElementById(a);r&&(r.disabled=!1)}),j.style.display="block"}
